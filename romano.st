Object subclass: #ROMANO	instanceVariableNames: 'rom roms dec roman1 roman2 roman3 roman4'	classVariableNames: ''	poolDictionaries: ''	category: 'romano'!!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/11/2019 12:38'!menosmil(roman2 includes:roms )ifTrue:[            0 to: 8 do: [:i|             ((roman2 at:(i+1)) =roms)ifTrue: [                       dec:=dec+(100*(9-i))]]].(roman3 includes:roms )ifTrue:[            0 to: 8 do: [:i|             ((roman3 at:(i+1)) =roms) ifTrue: [                       dec:=dec+(10*(9-i))]]].(roman4 includes:roms )ifTrue:[            0 to: 8 do: [:i|             ((roman4 at:(i+1)) =roms) ifTrue: [                       dec:=dec+(9-i)]]]! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 20:24'!noseencuentraarreglo(roman1 includes:roms)ifTrue:[                    0 to: 2 do: [:i|                      ((roman1 at:(i+1)) =roms) ifTrue: [                             dec:=dec+(1000*(3-i))]]].(roman2 includes:roms )ifTrue:[                    0 to: 8 do: [:i|                      ((roman2 at:(i+1)) =roms) ifTrue: [                          dec:=dec+(100*(9-i))]]].(roman3 includes:roms )ifTrue:[                      0 to: 8 do: [:i|                       ((roman3 at:(i+1)) =roms) ifTrue: [                           dec:=dec+(10*(9-i))]]].(roman4 includes:roms )ifTrue:[                       0 to: 8 do: [:i|                       ((roman4 at:(i+1)) =roms) ifTrue: [                          dec:=dec+(9-i)]]].								! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/11/2019 12:52'!romanomayor3self arreglos.(rom size = 4) ifTrue:[ 					((roman1 includes: rom)|(roman2 includes:rom)| (roman3 includes: rom)| (roman4 includes: rom)) 					ifTrue:[self seencuentraarreglo]					ifFalse:[     							roms:=(rom at:1)asString,(rom at:2)asString,(rom at:3)asString.								((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 								ifTrue:[self noseencuentraarreglo .        								  roms:=(rom at:4)asString.										  self menosmil.										 ]  							   ifFalse: [         									roms:= (rom at:1)asString,(rom at:2)asString.        									((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 											ifTrue: [self noseencuentraarreglo .    													roms:=(rom at:3)asString,(rom at:4)asString.   										  				((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 										  				ifTrue: [self menosmil ]    									 				ifFalse: [         											 				roms:=(rom at:3)asString.       														   self menosmil.       											 				roms:=(rom at:4)asString.        															self menoscien													           ]    													] 											ifFalse: [     													roms:=(rom at:1)asString.     													self noseencuentraarreglo .    													roms:=(rom at:2)asString,(rom at:3) asString,(rom at:4)asString.    													((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 										   				ifTrue: [self menosmil]   										  				ifFalse: [       												 				 roms:=(rom at:2)asString.        											  				 self noseencuentraarreglo .    												  				 roms:=(rom at:3)asString,(rom at:4)asString.    												  				 ((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 													 				 ifTrue: [self menosmil]    												 				 ifFalse: [																 				roms:= (rom at:3)asString.        														 				self menosmil.        																		roms:=(rom at:4)asString.        																		self menoscien         														 				]    												  				]													]											]							]		]ifFalse:[    					(rom size = 5) ifTrue:[     												roms:= (rom at:1)asString,(rom at:2)asString,(rom at:3)asString,(rom at:4)asString.   				 									((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 													ifTrue: [         														self menosmil.    															roms:=(rom at:5)asString.      															(roman3 includes:rom )																ifTrue:[self menoscien]																ifFalse: [    															   				roms:=(rom at:1)asString,(rom at:2)asString,(rom at:3)asString.    																		((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																			ifTrue: [        																				self noseencuentraarreglo .      																					roms:=(rom at:4)asString,(rom at:5)asString.     																					((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																									ifTrue: [self noseencuentraarreglo] 																									ifFalse: [ 																												roms:=(rom at:4)asString.  																												self menosmil.    																											roms:=(rom at:5)asString.    																											self menoscien 																											   ]                    																				]    																		ifFalse: [         																				roms:=(rom at:1)asString,(rom at:2)asString.        																				((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																						ifTrue: [        																							self noseencuentraarreglo .    																								roms:=(rom at:3)asString,(rom at:4)asString,(rom at:5)asString.  																								   ((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																									ifTrue: [self menosmil]        																							ifFalse: [          																										roms:=(rom at:3)asString,(rom at:4)asString.         																										((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																												ifTrue: [         																													self menosmil.       																													roms:=(rom at:5)asString.        																													self menoscien    																													  ]																												ifFalse: [         																													roms:=(rom at:3)asString.       																													self menosmil.       																													roms:=(rom at:5)asString.        																													self menoscien.    																														roms:=(rom at:4)asString,(rom at:5)asString.         																													((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																															ifTrue: [         																																self menosmil.       																																roms:=(rom at:5)asString.        																																self menoscien    																																	]																															ifFalse: [      																																	roms:=(rom at:4)asString.     																																	self menosmil.       																																roms:=(rom at:5)asString.        																																self menoscien.    																																	]            																														]    																											]   																									]																						ifFalse: [       																								roms:= (rom at:1)asString.     																								self noseencuentraarreglo .    																								roms:=roms:=(rom at:2)asString,(rom at:3)asString,(rom at:4)asString,(rom at:5)asString.    																								((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																									ifTrue: [self menosmil]																									ifFalse: [     																											roms:=roms:=(rom at:2)asString,(rom at:3)asString,(rom at:4)asString.																												((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																												ifTrue: [          																													self menosmil.    																														roms:=(rom at:5)asString.																															self menoscien    																													  ]																												ifFalse: [     																														roms:=roms:=(rom at:2)asString,(rom at:3)asString.    																														((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																															ifTrue: [         																																self menosmil.    																																	roms:=(rom at:4)asString,(rom at:5)asString.    																																	((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																																		ifTrue: [self menosmil]																																		ifFalse: [ 																																					roms:=(rom at:4)asString.    																																				self menosmil.																																					roms:=(rom at:5)asString.																																					self menoscien																																					]																																		] 																															ifFalse: [																																		roms:=(rom at:2)asString. 																																		self menosmil.																																		roms:=(rom at:3)asString,(rom at:4)asString,(rom at:5)asString.																																		((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																																		ifTrue: [self menosmil]																																		ifFalse: [																																			 		roms:=(rom at:3)asString,(rom at:4)asString.																																					((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms)) 																																					ifTrue: [ 																																								self menosmil.																																								roms:=(rom at:5)asString.																																								self menoscien																																							  ]																																					ifFalse: [ 																																								roms:=roms:=(rom at:3)asString.																																								self menosmil.																																								roms:=(rom at:4)asString,(rom at:5)asString.																																								((roman1 includes: roms)|(roman2 includes:roms)| (roman3 includes: roms)| (roman4 includes: roms))																																								ifTrue: [self menosmil]																																								ifFalse: [ 																																											roms:=(rom at:4)asString.																																											self menosmil.																																											roms:=(rom at:5)asString.																																											self menoscien																																											]																																								]																																					 ]																																		]																															]																												]																									]																						]																			]																]													]										]     ! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 20:25'!seencuentraarreglo(roman1 includes:rom )ifTrue:[            0 to: 2 do: [:i|             ((roman1 at:(i+1)) =rom) ifTrue: [                       dec:=dec+(1000*(3-i))]]].(roman2 includes:rom )ifTrue:[            0 to: 8 do: [:i|             ((roman2 at:(i+1)) =rom) ifTrue: [                       dec:=dec+(100*(9-i))]]].(roman3 includes:rom )ifTrue:[            0 to: 8 do: [:i|             ((roman3 at:(i+1)) =rom) ifTrue: [                       dec:=dec+(10*(9-i))]]]. (roman4 includes:rom )ifTrue:[            0 to: 8 do: [:i|             ((roman4 at:(i+1)) =rom) ifTrue: [                       dec:=dec+(9-i)]]].! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 21:41'!romanoigual3self arreglos.((roman1 includes:rom)| (roman2 includes:rom)|(roman3 includes:rom)| (roman4 includes:rom))ifTrue:[self seencuentraarreglo]ifFalse:[ 	   "tomamos primer y segundo caracter del numero romano. Ej: 'XX' este no: 'I'"		roms:=(rom at:1)asString,(rom at:2)asString.		"verificamos si se encuentra en los arreglos"		((roman1 includes:roms)| (roman2 includes:roms)|(roman3 includes: roms)|(roman4 includes: roms))		ifTrue:[ 		self noseencuentraarreglo.		"una vez que encontro los dos primeros, TOMAMOS solo el ULTIMO caracter del numero romano. Ej: este no:'XX' este SI: 'I'"		roms:=(rom at: 3)asString.		self menosmil]		ifFalse:[ "Cuando no se encontraron los dos primeros caracteres CONSECUTIVOS, se toma SOLO EL primero Ej: N¬¨‚àû= MCM, tomamos solo 'M'y  no:'CM' "		roms:= (rom at:1)asString.		self noseencuentraarreglo ."Una vez que se analizo el primero caracter, analizamos los DOS ultimos Ej: N¬¨‚àû= MCM, no 'M',si:'CM' "		      roms:=(rom at:2)asString,(rom at:3)asString.		((roman2 includes: roms)|(roman3 includes: roms)|(roman4 includes: roms)) 		ifTrue:[self menosmil]		"Cuando no se encuentran los dos ultimos caracteres, analiza POR SEPARADO, los dos ultimos caracteres Ej: N¬¨‚àû= MCI, (en ninguna combinacion posible, de los mismos caracteres, se encuentran en el arreglo). "		ifFalse:[roms:= (rom at:2)asString.					self menosmil.					roms:= (rom at:3) asString.					self menoscien]				  ]		]! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 21:11'!menoscien(roman3 includes:roms )ifTrue:[            0 to: 8 do: [:i|             ((roman3 at:(i+1)) =roms) ifTrue: [                       dec:=dec+(10*(9-i))]]].        (roman4 includes:roms )ifTrue:[             0 to: 8 do: [:i|             ((roman4 at:(i+1)) =roms) ifTrue: [                       dec:=dec+(9-i)]]]! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 20:01'!romanomenor3self arreglos.((roman1 includes:rom) | (roman2 includes:rom) | (roman3 includes:rom) | (roman4 includes:rom))ifTrue:[self seencuentraarreglo]ifFalse:["ASIGNAMOS EL PRIMER CARACTER" roms:= (rom at: 1)asString. self noseencuentraarreglo."ASIGNAMOS EL SEGUNDO CARACTER" roms:= (rom at:2)asString. self noseencuentraarreglo. ].! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 20:05'!romanorom:=(UIManager default request: 'Ingrese numero romano')asUppercase.rom isNil ifTrue:[^nil].(rom size <3)ifTrue:[self romanomenor3].(rom size =3)ifTrue:[self romanoigual3].(rom size >3)ifTrue:[self romanomayor3].^dec.! !!ROMANO methodsFor: 'access' stamp: 'Anonymous 9/10/2019 19:59'!arreglosroms:=''.dec:=0.roman1:= #('MMM' 'MM' 'M').roman2:= #('CM' 'DCCC' 'DCC' 'DC' 'D' 'CD' 'CCC' 'CC' 'C'). roman3:= #('XC' 'LXXX' 'LXX' 'LX' 'L' 'XL' 'XXX' 'XX' 'X'). roman4:= #('IX' 'VIII' 'VII' 'VI' 'V' 'IV' 'III' 'II' 'I').! !